
namespace dm
{

static const size_t NUM_COLORS = 64;

static const float line_colormap[NUM_COLORS][3] = {
  {0,0,1},
  {0,0.5,0},
  {1,0,0},
  {0,0.75,0.75},
  {0.75,0,0.75},
  {0.75,0.75,0},
  {0.25,0.25,0.25},
  {0,0,1},
  {0,0.5,0},
  {1,0,0},
  {0,0.75,0.75},
  {0.75,0,0.75},
  {0.75,0.75,0},
  {0.25,0.25,0.25},
  {0,0,1},
  {0,0.5,0},
  {1,0,0},
  {0,0.75,0.75},
  {0.75,0,0.75},
  {0.75,0.75,0},
  {0.25,0.25,0.25},
  {0,0,1},
  {0,0.5,0},
  {1,0,0},
  {0,0.75,0.75},
  {0.75,0,0.75},
  {0.75,0.75,0},
  {0.25,0.25,0.25},
  {0,0,1},
  {0,0.5,0},
  {1,0,0},
  {0,0.75,0.75},
  {0.75,0,0.75},
  {0.75,0.75,0},
  {0.25,0.25,0.25},
  {0,0,1},
  {0,0.5,0},
  {1,0,0},
  {0,0.75,0.75},
  {0.75,0,0.75},
  {0.75,0.75,0},
  {0.25,0.25,0.25},
  {0,0,1},
  {0,0.5,0},
  {1,0,0},
  {0,0.75,0.75},
  {0.75,0,0.75},
  {0.75,0.75,0},
  {0.25,0.25,0.25},
  {0,0,1},
  {0,0.5,0},
  {1,0,0},
  {0,0.75,0.75},
  {0.75,0,0.75},
  {0.75,0.75,0},
  {0.25,0.25,0.25},
  {0,0,1},
  {0,0.5,0},
  {1,0,0},
  {0,0.75,0.75},
  {0.75,0,0.75},
  {0.75,0.75,0},
  {0.25,0.25,0.25},
  {0,0,1}
};

static const float jet_colormap[NUM_COLORS][3] = {
  {0,0,0.5625},
  {0,0,0.625},
  {0,0,0.6875},
  {0,0,0.75},
  {0,0,0.8125},
  {0,0,0.875},
  {0,0,0.9375},
  {0,0,1},
  {0,0.0625,1},
  {0,0.125,1},
  {0,0.1875,1},
  {0,0.25,1},
  {0,0.3125,1},
  {0,0.375,1},
  {0,0.4375,1},
  {0,0.5,1},
  {0,0.5625,1},
  {0,0.625,1},
  {0,0.6875,1},
  {0,0.75,1},
  {0,0.8125,1},
  {0,0.875,1},
  {0,0.9375,1},
  {0,1,1},
  {0.0625,1,0.9375},
  {0.125,1,0.875},
  {0.1875,1,0.8125},
  {0.25,1,0.75},
  {0.3125,1,0.6875},
  {0.375,1,0.625},
  {0.4375,1,0.5625},
  {0.5,1,0.5},
  {0.5625,1,0.4375},
  {0.625,1,0.375},
  {0.6875,1,0.3125},
  {0.75,1,0.25},
  {0.8125,1,0.1875},
  {0.875,1,0.125},
  {0.9375,1,0.0625},
  {1,1,0},
  {1,0.9375,0},
  {1,0.875,0},
  {1,0.8125,0},
  {1,0.75,0},
  {1,0.6875,0},
  {1,0.625,0},
  {1,0.5625,0},
  {1,0.5,0},
  {1,0.4375,0},
  {1,0.375,0},
  {1,0.3125,0},
  {1,0.25,0},
  {1,0.1875,0},
  {1,0.125,0},
  {1,0.0625,0},
  {1,0,0},
  {0.9375,0,0},
  {0.875,0,0},
  {0.8125,0,0},
  {0.75,0,0},
  {0.6875,0,0},
  {0.625,0,0},
  {0.5625,0,0},
  {0.5,0,0}
};

static const float hot_colormap[NUM_COLORS][3] = {
  {0.041667,0,0},
  {0.083333,0,0},
  {0.125,0,0},
  {0.16667,0,0},
  {0.20833,0,0},
  {0.25,0,0},
  {0.29167,0,0},
  {0.33333,0,0},
  {0.375,0,0},
  {0.41667,0,0},
  {0.45833,0,0},
  {0.5,0,0},
  {0.54167,0,0},
  {0.58333,0,0},
  {0.625,0,0},
  {0.66667,0,0},
  {0.70833,0,0},
  {0.75,0,0},
  {0.79167,0,0},
  {0.83333,0,0},
  {0.875,0,0},
  {0.91667,0,0},
  {0.95833,0,0},
  {1,0,0},
  {1,0.041667,0},
  {1,0.083333,0},
  {1,0.125,0},
  {1,0.16667,0},
  {1,0.20833,0},
  {1,0.25,0},
  {1,0.29167,0},
  {1,0.33333,0},
  {1,0.375,0},
  {1,0.41667,0},
  {1,0.45833,0},
  {1,0.5,0},
  {1,0.54167,0},
  {1,0.58333,0},
  {1,0.625,0},
  {1,0.66667,0},
  {1,0.70833,0},
  {1,0.75,0},
  {1,0.79167,0},
  {1,0.83333,0},
  {1,0.875,0},
  {1,0.91667,0},
  {1,0.95833,0},
  {1,1,0},
  {1,1,0.0625},
  {1,1,0.125},
  {1,1,0.1875},
  {1,1,0.25},
  {1,1,0.3125},
  {1,1,0.375},
  {1,1,0.4375},
  {1,1,0.5},
  {1,1,0.5625},
  {1,1,0.625},
  {1,1,0.6875},
  {1,1,0.75},
  {1,1,0.8125},
  {1,1,0.875},
  {1,1,0.9375},
  {1,1,1}
};

static const float hsv_colormap[NUM_COLORS][3] = {
  {1,0,0},
  {1,0.09375,0},
  {1,0.1875,0},
  {1,0.28125,0},
  {1,0.375,0},
  {1,0.46875,0},
  {1,0.5625,0},
  {1,0.65625,0},
  {1,0.75,0},
  {1,0.84375,0},
  {1,0.9375,0},
  {0.96875,1,0},
  {0.875,1,0},
  {0.78125,1,0},
  {0.6875,1,0},
  {0.59375,1,0},
  {0.5,1,0},
  {0.40625,1,0},
  {0.3125,1,0},
  {0.21875,1,0},
  {0.125,1,0},
  {0.03125,1,0},
  {0,1,0.0625},
  {0,1,0.15625},
  {0,1,0.25},
  {0,1,0.34375},
  {0,1,0.4375},
  {0,1,0.53125},
  {0,1,0.625},
  {0,1,0.71875},
  {0,1,0.8125},
  {0,1,0.90625},
  {0,1,1},
  {0,0.90625,1},
  {0,0.8125,1},
  {0,0.71875,1},
  {0,0.625,1},
  {0,0.53125,1},
  {0,0.4375,1},
  {0,0.34375,1},
  {0,0.25,1},
  {0,0.15625,1},
  {0,0.0625,1},
  {0.03125,0,1},
  {0.125,0,1},
  {0.21875,0,1},
  {0.3125,0,1},
  {0.40625,0,1},
  {0.5,0,1},
  {0.59375,0,1},
  {0.6875,0,1},
  {0.78125,0,1},
  {0.875,0,1},
  {0.96875,0,1},
  {1,0,0.9375},
  {1,0,0.84375},
  {1,0,0.75},
  {1,0,0.65625},
  {1,0,0.5625},
  {1,0,0.46875},
  {1,0,0.375},
  {1,0,0.28125},
  {1,0,0.1875},
  {1,0,0.09375}
};

static const float gray_colormap[NUM_COLORS][3] = {
  {0,0,0},
  {0.015873,0.015873,0.015873},
  {0.031746,0.031746,0.031746},
  {0.047619,0.047619,0.047619},
  {0.063492,0.063492,0.063492},
  {0.079365,0.079365,0.079365},
  {0.095238,0.095238,0.095238},
  {0.11111,0.11111,0.11111},
  {0.12698,0.12698,0.12698},
  {0.14286,0.14286,0.14286},
  {0.15873,0.15873,0.15873},
  {0.1746,0.1746,0.1746},
  {0.19048,0.19048,0.19048},
  {0.20635,0.20635,0.20635},
  {0.22222,0.22222,0.22222},
  {0.2381,0.2381,0.2381},
  {0.25397,0.25397,0.25397},
  {0.26984,0.26984,0.26984},
  {0.28571,0.28571,0.28571},
  {0.30159,0.30159,0.30159},
  {0.31746,0.31746,0.31746},
  {0.33333,0.33333,0.33333},
  {0.34921,0.34921,0.34921},
  {0.36508,0.36508,0.36508},
  {0.38095,0.38095,0.38095},
  {0.39683,0.39683,0.39683},
  {0.4127,0.4127,0.4127},
  {0.42857,0.42857,0.42857},
  {0.44444,0.44444,0.44444},
  {0.46032,0.46032,0.46032},
  {0.47619,0.47619,0.47619},
  {0.49206,0.49206,0.49206},
  {0.50794,0.50794,0.50794},
  {0.52381,0.52381,0.52381},
  {0.53968,0.53968,0.53968},
  {0.55556,0.55556,0.55556},
  {0.57143,0.57143,0.57143},
  {0.5873,0.5873,0.5873},
  {0.60317,0.60317,0.60317},
  {0.61905,0.61905,0.61905},
  {0.63492,0.63492,0.63492},
  {0.65079,0.65079,0.65079},
  {0.66667,0.66667,0.66667},
  {0.68254,0.68254,0.68254},
  {0.69841,0.69841,0.69841},
  {0.71429,0.71429,0.71429},
  {0.73016,0.73016,0.73016},
  {0.74603,0.74603,0.74603},
  {0.7619,0.7619,0.7619},
  {0.77778,0.77778,0.77778},
  {0.79365,0.79365,0.79365},
  {0.80952,0.80952,0.80952},
  {0.8254,0.8254,0.8254},
  {0.84127,0.84127,0.84127},
  {0.85714,0.85714,0.85714},
  {0.87302,0.87302,0.87302},
  {0.88889,0.88889,0.88889},
  {0.90476,0.90476,0.90476},
  {0.92063,0.92063,0.92063},
  {0.93651,0.93651,0.93651},
  {0.95238,0.95238,0.95238},
  {0.96825,0.96825,0.96825},
  {0.98413,0.98413,0.98413},
  {1,1,1}
};

template<class T>
void colormap(const T& val,
              const T& min_val,
              const T& max_val,
              const float cmap[NUM_COLORS][3],
              float rgb[3]) {
  T val2 = (val < min_val ? min_val : val);
  val2 = (val2 > max_val ? max_val : val2);
  int ix = static_cast<int>(NUM_COLORS*((val2-min_val)/(max_val-min_val)));
  ix = std::min(std::max(0, ix), static_cast<int>(NUM_COLORS-1));
  rgb[0] = cmap[ix][0];
  rgb[1] = cmap[ix][1];
  rgb[2] = cmap[ix][2];
}

}
